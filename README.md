Main/src code ported through Rojo. Outdated (2020 ver)
